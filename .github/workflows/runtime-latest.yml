name: Runtime Latest (Non-blocking)

on:
  schedule:
    - cron: "11 4 * * 2"
  workflow_dispatch:

permissions:
  contents: read

concurrency:
  group: runtime-latest-${{ github.ref }}
  cancel-in-progress: true

jobs:
  latest-smoke:
    name: Latest runtime smoke (informational)
    runs-on: ubuntu-latest
    timeout-minutes: 20
    continue-on-error: true
    steps:
      - name: Checkout
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2
      - name: Setup Node (latest stable)
        uses: actions/setup-node@6044e13b5dc448c55e2357c09f80417699197238 # v6.2.0
        with:
          node-version: current
          cache: npm
      - name: Setup Deno (latest stable)
        uses: denoland/setup-deno@e95548e56dfa95d4e1a28d6f422fafe75c4c26fb # v2.0.3
        with:
          deno-version: latest
      - name: Setup Bun (latest stable)
        uses: oven-sh/setup-bun@3d267786b128fe76c2f16a390aa2448b815359f3 # v2.1.2
        with:
          bun-version: latest
      - name: Install
        run: npm ci
      - name: Runtime staleness policy
        run: node ./scripts/runtime-staleness-check.mjs
      - name: One-command truth
        run: npm run check
